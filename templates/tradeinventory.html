{% load static %}

<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- title -->
  {% for InventoryObject in Titles %}
  {% if InventoryObject.page == "inventory.html" or InventoryObject.page == "base.html" %}
  <title>{{InventoryObject.overtitle}}</title>
  {% endif %}
  {% endfor %}

	<!-- favicon -->
	<link rel="shortcut icon" type="image/png" href="static/img/favicon.png">
	<!-- google font -->
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Poppins:400,700&display=swap" rel="stylesheet">
	<!-- fontawesome -->
    <link rel="stylesheet" type="text/css" href="{% static 'css/all.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/bootstrap.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/owl.carousel.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/animate.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/meanmenu.min.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" type="text/css" href="{% static 'css/responsive.css' %}">

</head>
<body style="">
{% for message in messages %}
    <div class="alert alert-{{ message.tags }}">
      {{ message }}
    </div>
  {% endfor %}

<!--PreLoader-->
  <div class="loader">
        <div class="loader-inner">
            <div class="circle"></div>
        </div>
    </div>
    <!--PreLoader Ends-->

	<!-- header -->
	<div class="top-header-area" id="sticker" style="background: linear-gradient(rgba(0, 0, 0, 1) 5%, rgba(0,0,0,0)); position: fixed;">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 col-sm-12 text-center">
					<div class="main-menu-wrap">
						<!-- logo -->
						<div class="site-logo">
							{% for GameChestBackgroundView in Logo %}
								{% if GameChestBackgroundView.page == 'game.html' %}
								<a class="logo" href="{{GameChestBackgroundView.hyperlink}}">
								  <img class="imageicon" src="{{GameChestBackgroundView.logocover.url}}"
										alt="{{GameChestBackgroundView.alternate}}" style="length: {{GameChestBackgroundView.length_for_resize}}px; width: {{GameChestBackgroundView.width_for_resize}}px;"></a>
								{% endif %}
							{% endfor %}
						</div>
						<!-- logo -->

						<!-- menu start -->
						<nav class="main-menu">
							<ul>
							  {% for column in Header %}

      <li class="current-list-item"><a href="#{{ column.section }}">{{ column.text }}</a>
									<ul class="sub-menu">
										{% for row in DropDown %}
          {% if row.row == column.row %}
            {% if row.url == 'http://127.0.0.1:8000/profile' %}
              {% if row.opennew %}
										<li> <a href="{{ profile_url }}" target="_blank">{{ row.text }}</a></li>
              {% else %}
										<li> <a href="{{ profile_url }}">{{ row.text }}</a></li>
              {% endif %}
            {% else %}
              {% if row.opennew %}
										<li><a href="{{ row.url }}" target="_blank">{{ row.text }}</a></li>
              {% else %}
										<li><a href="{{ row.url }}">{{ row.text }}</a></li>
              {% endif %}
            {% endif %}
          {% endif %}
        {% endfor %}
									</ul>
        {% endfor %}
								</li>
								<li>
									<div class="header-icons" style="display: flex; flex-direction: right;">
										<a class="shopping-cart" href="{% url 'showcase:ehome' %}">
											<img src="{% static 'css/images/cart.png' %}" style="width: 15px; height: 15px;">
										</a>
										<a class="mobile-hide search-bar-icon" href="#"><img src="{% static 'css/images/search-icon.png' %}" style="width: 20px; height: 15px;"></a>
									</div>



								</li>
								<li style="margin-right: -10%;">
									{% for userprofile in Profiles %}
									{% if userprofile.newprofile_profile_picture_url %}
									<a href="{{ userprofile.newprofile_profile_url }}">
										<img src="{{ userprofile.newprofile_profile_picture_url }}" alt="Profile Picture" width="50" height="50" style="border-radius: 50px; margin-right: 20px;">
									</a>
									{% else %}
									<!-- Placeholder image or default avatar -->
									<img src="{% static 'css/images/a.jpg' %}" alt="Default Avatar" width="50" height="50" style="border-radius: 50px;">
									{% endif %}
									{% endfor %}
								</li>
							</ul>
						</nav>
						<a class="mobile-show search-bar-icon" href="#"><i class="fas fa-search"></i></a>
						<div class="mobile-menu"></div>
						<!-- menu end -->
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end header -->

	<!-- search area -->
<div class="search-area">
    <div class="container">
       <div class="row">
          <div class="col-lg-12">
             <span class="close-btn"><img src=""></i></span>
             <div class="search-bar">
                <div class="search-bar-tablecell">
                   <h3>What are you looking for?</h3>
                   <form action="{% url 'showcase:pagesearch' %}" method="post">
                       {% csrf_token %}
                       <input type="text" name="search_query" placeholder="Keywords">
                       <select name="search_type">
                           <option value="text">Text</option>
                           <option value="url">URL</option>
                       </select>
                       <button type="submit">Search <i class="fas fa-search"></i></button>
                   </form>
                </div>
             </div>
          </div>
       </div>
    </div>
</div>

<!-- end search area -->

	<!-- breadcrumb-section -->
{% for InventoryObject in Background %}
  {% if InventoryObject.page == "inventory.html" %}
  {% if InventoryObject.position == 1 %}
	<div class="breadcrumb-section breadcrumb-bg" style="background: url({{InventoryObject.cover.url}}); background-size: cover; min-height: 70vh;">
        {% endif %}
        {% endif %}
        {% endfor %}
		<div class="container">
			<div class="row">
				<div class="col-lg-8 offset-lg-2 text-center">
					<div class="breadcrumb-text">
						<p>PokeTrove INC</p>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end breadcrumb section -->

			<!-- product section -->
	<div class="product-section mt-150 mb-150">
<strong>{{ user.username }}</strong> -
    <span id="currency-amount">{{ SentProfile.currency_amount }} Rubies </span>
		<div class="container">
			<div class="row">
				<div class="col-lg-8 offset-lg-2 text-center">
					<div class="section-title">
						<h3><span class="orange-text">My</span> Trade Inventory - (<span id="stock-count">{{ TradeItems|length }}</span>)</h3>

						{% for BackgroundImage in TextFielde %}
						{% if BackgroundImage.page == "inventory.html" %}
						{% if BackgroundImage.section == 1 %}
						<p>{{BackgroundImage.text}}</p>
					    {% endif %}
						{% endif %}
						{% endfor %}
					</div>
				</div>
			</div><style>
  .inventory-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 2rem;
    padding: 2rem;
  }

  .inventory-item {
    position: relative;
    width: 300px;
    height: 450px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 15px;
    overflow: hidden;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    transition: all 0.3s ease;
  }

  .inventory-item:hover {
    transform: translateY(-10px);
    box-shadow: 0 15px 40px rgba(0, 0, 0, 0.5);
  }

  .product-image {
    width: 100%;
    height: 250px;
    overflow: hidden;
  }

  .product-image img {
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .inventory-item:hover .product-image img {
    transform: scale(1.1);
  }

  .product-info {
    padding: 1.5rem;
    color: #fff;
    padding-bottom: 1rem;
  }

  .product-name {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 0.5rem;
    text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
  }

  .product-condition {
    font-size: 0.9rem;
    color: green;
    margin-bottom: 0.5rem;
  }

  .product-description {
    font-size: 0.9rem;
    margin-bottom: 1rem;
    opacity: 0.8;
  }

  .action-buttons {
    display: flex;
    justify-content: space-between;
    gap: 0.5rem;
  }

  .action-button {
    flex: 1;
    padding: 0.5rem;
    border: none;
    border-radius: 5px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .sell-button {
    background-color: #4caf50;
    color: white;
  }

  .withdraw-button {
    background-color: #f44336;
    color: white;
  }

  .trade-button {
    background-color: #2196f3;
    color: white;
  }

  .action-button:hover {
    filter: brightness(1.2);
    transform: translateY(-2px);
  }

  .empty-inventory {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    color: #fff;
    text-align: center;
  }

  .empty-inventory img {
    width: 300px;
    height: 300px;
    margin-bottom: 2rem;
    border-radius: 50%;
    box-shadow: 0 8px 32px rgba(255, 255, 255, 0.1);
  }

  .empty-inventory h3 {
    font-size: 1.5rem;
    max-width: 80%;
    line-height: 1.5;
  }
</style>

<div class="inventory-container">
  {% for TradeItem in TradeItems %}
    <div class="inventory-item">
      <div class="product-image">
        <img src="{{ TradeItem.image.url }}" alt="Product Image">
      </div>
      <div class="product-info">
        <h3 class="product-name">{{ TradeItem.title }}</h3>
        <h3 class="product-name">{{ TradeItem.value }} ðŸ’Ž</h3>
        <p class="product-condition">Card Condition: {{ TradeItem.condition }}</p>
        <p class="product-description">{{ TradeItem.description }}</p>
        <div class="action-buttons" style="position: fixed;">
			{% if TradeItem.certified == True %}
                <form method="post" action="">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="inventory_remove">
                    <input type="hidden" name="pk" value="{{ TradeItem.pk }}">

                    <button type="submit" class="cart-btn">Move To My Inventory</button>
				</form>
			 {% else %}
               <form method="post" action="">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="remove">
                    <input type="hidden" name="pk" value="{{ TradeItem.pk }}">

                    <button type="submit" class="cart-btn">Remove From Trade Inventory</button>
				</form>
			 {% endif %}

        </div>
      </div>
    </div>
  {% empty %}
    <div class="empty-inventory">
      <img src="{% static 'css/images/broke.gif' %}" alt="broke buddy">
      <h3>Looks like you don't have anything here! Time to pull some bangers!</h3>
    </div>
  {% endfor %}
</div>




			</div>
				</div>
		</div>
		</div>
	</div>
	<!-- end product section -->


			<div class="row">
				<div class="container">
					<div class="row">
						<div class="col-lg-12 text-center">
							<div class="pagination-wrap">
								<ul>
									<li><a href="#">Prev</a></li>
									<li><a href="#">1</a></li>
									<li><a class="active" href="#">2</a></li>
									<li><a href="#">3</a></li>
									<li><a href="#">Next</a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
	<!-- end latest news -->

	<!-- PokeTrove Logos carousel -->
	<div class="logo-carousel-section">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="logo-carousel-inner">
						{% for InventoryObject in Image %}
						{% if InventoryObject.page == 'inventory.html' %}
                  		{% if InventoryObject.image_position == 2 %}
						<div class="single-logo-item">
							<a href="{{ InventoryObject.hyperlink }}">
							<img src="{{ InventoryObject.image.url }}" alt="">
							</a>
						</div>
						{% endif %}
						{% endif %}
						{% endfor %}

						{% for InventoryObject in Image %}
						{% if InventoryObject.page == 'inventory.html' %}
                  		{% if InventoryObject.image_position == 3 %}
						<div class="single-logo-item">
							<a href="{{ InventoryObject.hyperlink }}">
							<img src="{{ InventoryObject.image.url }}" alt="">
							</a>
						</div>
						{% endif %}
						{% endif %}
						{% endfor %}

						{% for InventoryObject in Image %}
						{% if InventoryObject.page == 'inventory.html' %}
                  		{% if InventoryObject.image_position == 4 %}
						<div class="single-logo-item">
							<a href="{{ InventoryObject.hyperlink }}">
							<img src="{{ InventoryObject.image.url }}" alt="">
							</a>
						</div>
						{% endif %}
						{% endif %}
						{% endfor %}

						{% for InventoryObject in Image %}
						{% if InventoryObject.page == 'inventory.html' %}
                  		{% if InventoryObject.image_position == 5 %}
						<div class="single-logo-item">
							<a href="{{ InventoryObject.hyperlink }}">
							<img src="{{ InventoryObject.image.url }}" alt="">
							</a>
						</div>
						{% endif %}
						{% endif %}
						{% endfor %}

						{% for InventoryObject in Image %}
						{% if InventoryObject.page == 'inventory.html' %}
                  		{% if InventoryObject.image_position == 6 %}
						<div class="single-logo-item">
							<a href="{{ InventoryObject.hyperlink }}">
							<img src="{{ InventoryObject.image.url }}" alt="">
							</a>
						</div>
						{% endif %}
						{% endif %}
						{% endfor %}
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end logo carousel -->

	<!-- footer -->
	<div class="footer-area">
		<div class="container">
			<div class="row">
				<div class="col-lg-3 col-md-6">
					<div class="footer-box about-widget">
						<h2 class="widget-title">About Us</h2>
                            {% for InventoryObject in TextFielde %}
							{% if InventoryObject.page == "inventory.html" %}
							{% if InventoryObject.section == 1 %}
							<p>{{InventoryObject.text}}</p>
						  	{% endif %}
							{% endif %}
							{% endfor %}
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box get-in-touch">
						<h2 class="widget-title">Join Our Community! </h2>
						<ul>
							<li>34/8, East Hukupara, Gifirtok, Sadan.</li>
							<li><a href="{% url 'showcase:contact' %}" target='_blank' style="text-decoration: none;">IntelleXCompany1@gmail.com</a></li>
							<li>+00 111 222 3333</li>
                            <li><a href="{% url 'showcase:home' %}" target='_blank' style="text-decoration: none;">Live Communitiies</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box pages">
						<h2 class="widget-title">Pages</h2>
						<ul>
							<li><a href="{% url 'showcase:index' %}">Home</a></li>
							<li><a href="{% url 'showcase:about' %}">About</a></li>
							<li><a href="{% url 'showcase:ehome' %}">Shop</a></li>
							<li><a href="{% url 'showcase:newsfeed' %}">News</a></li>
							<li><a href="{% url 'showcase:contact' %}">Contact</a></li>
						</ul>
					</div>
				</div>
				<div class="col-lg-3 col-md-6">
					<div class="footer-box subscribe">
						<h2 class="widget-title">Subscribe</h2>
						<p>Subscribe to our mailing list to get the latest updates.</p>
						<form method="post" action="">
    						{% csrf_token %}
							{{ form.email }}

							<button type="submit"><i class="fas fa-paper-plane"></i></button>
													<br>
							I agree to the Terms & Conditions: {{ form.confirmation }}
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end footer -->

	<!-- copyright -->
	<div class="copyright">
		<div class="container">
			<div class="row">
				<div class="col-lg-6 col-md-12">
					{% for InventoryObject in BaseCopyrightTextFielded %}
					{% if InventoryObject.page == "inventory.html" %}
					<p>{{InventoryObject.copyright}}</p>
					{% endif %}
					{% endfor %}
				</div>
				<div class="col-lg-6 text-right col-md-12">
					<div class="social-icons">
						<ul>
							<li><a href="#" target="_blank"><i class="fab fa-facebook-f"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-twitter"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-instagram"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-linkedin"></i></a></li>
							<li><a href="#" target="_blank"><i class="fab fa-dribbble"></i></a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- end copyright -->
<script>
document.addEventListener("DOMContentLoaded", function () {
    const forms = document.querySelectorAll(".ajax-form");

    forms.forEach(form => {
        form.addEventListener("submit", function (event) {
            event.preventDefault();

            const formData = new FormData(this);
            const url = this.getAttribute("action");
            const csrfToken = formData.get("csrfmiddlewaretoken");

            fetch(url, {
                method: "POST",
                headers: {
                    "X-CSRFToken": csrfToken,
                },
                body: formData,
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    // Update stock count
                    const stockCountElement = document.querySelector("#stock-count");
                    if (stockCountElement) {
                        stockCountElement.textContent = data.stock_count;
                    }

                    // Update currency amount
                    const currencyAmountElement = document.querySelector("#currency-amount");
                    if (currencyAmountElement) {
                        currencyAmountElement.textContent = data.currency_amount;
                    }

                    // Example: Remove the item from the UI
                    this.closest(".inventory-item").remove();
                } else {
                    console.error("Action failed.");
                }
            })
            .catch(error => {
                console.error("Error:", error);
            });
        });
    });
});



</script>
<script>
	document.addEventListener("DOMContentLoaded", function () {
    const withdrawButtons = document.querySelectorAll(".withdraw-button");

    withdrawButtons.forEach((button) => {
        button.addEventListener("click", function (event) {
            event.preventDefault();

            const form = button.closest("form");
            const formData = new FormData(form);
            const actionUrl = form.getAttribute("action") || window.location.href;

            fetch(actionUrl, {
                method: "POST",
                body: formData,
                headers: {
                    "X-Requested-With": "XMLHttpRequest",
                },
            })
                .then((response) => response.json())
                .then((data) => {
                    if (data.success) {
                        // Remove the withdrawn inventory item from the DOM
                        const inventoryItem = form.closest(".inventory-item");
                        if (inventoryItem) {
                            inventoryItem.remove();
                        }

                        // Update the stock count
                        const stockCountElement = document.getElementById("stock-count");
                        if (stockCountElement) {
                            const newCount = parseInt(stockCountElement.textContent) - 1;
                            stockCountElement.textContent = newCount;
                        }

                    } else {
                        alert(data.error || "An error occurred while processing your request.");
                    }
                })
                .catch((error) => {
                    console.error("Error:", error);
                    alert("An unexpected error occurred. Please try again.");
                });
        });
    });
});

</script>
	<!-- jquery -->
     <script src="{% static 'css/js/jquery-1.11.3.min.js' %}"></script>
     <script src="{% static 'css/js/main.js' %}"></script>
     <script src="{% static 'css/js/css/bootstrapper.min.js' %}"></script>
     <script src="{% static 'css/js/jquery.countdown.js' %}"></script>
     <script src="{% static 'css/js/jquery.isotope-3.0.6.min.js' %}"></script>
     <script src="{% static 'css/js/waypoints.js' %}"></script>
	 <script src="{% static 'css/js/jquery.magnific-popup.min.js' %}"></script>
     <script src="{% static 'css/js/owl.carousel.min.js' %}"></script>
     <script src="{% static 'css/js/jquery.meanmenu.min.js' %}"></script>
     <script src="{% static 'css/js/sticker.js' %}"></script>

</body>
</html>




			{% for TradeItem in TradeItems %}
			<div class="row" style="display: flex; max-width: 100%;">
				<div class="col-lg-4 col-md-6 text-center">
					<div class="single-product-item">
						<div class="product-image">
							<a href="single-product.html">
								<img src="{{TradeItem.image.url}}" style="height: 200px;">
							</a>
						</div>
						<h3>{{TradeItem.title}}</h3>

                 <p class="product-price">
                        <span style="">{{TradeItem.condition}}</span> </p>
                        <span style="">{{TradeItem.description}}</span> </p>
						 <div class="cart-btn">

			{% if TradeItem.certified == True %}
                <form method="post" action="">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="inventory_remove">
                    <input type="hidden" name="pk" value="{{ TradeItem.pk }}">

                    <button type="submit" class="cart-btn">Move To My Inventory</button>
				</form>
			 {% else %}
               <form method="post" action="">
                    {% csrf_token %}
                    <input type="hidden" name="action" value="remove">
                    <input type="hidden" name="pk" value="{{ TradeItem.pk }}">

                    <button type="submit" class="cart-btn">Remove From Trade Inventory</button>
				</form>
			 {% endif %}
						 </div></a></div>

					</div>
				</div>
				{% endfor %}
