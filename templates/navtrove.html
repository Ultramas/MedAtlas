{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:title" content="PokeTrove - Catch and Collect!" />
    <meta property="og:description" content="Play, collect, and trade unique creatures and rewards at PokeTrove!" />
    <meta property="og:image" content="https://www.poketrove.store/static/images/embed-banner.png" />
    <meta property="og:url" content="https://www.poketrove.store/" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="PokeTrove" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="PokeTrove - Catch and Collect!" />
    <meta name="twitter:description" content="Play, collect, and trade unique creatures and rewards at PokeTrove!" />
    <meta name="twitter:image" content="https://www.poketrove.store/static/images/embed-banner.png" />
    <meta name="twitter:url" content="https://www.poketrove.store/" />
    <title>PokeTrove</title>
    <meta name="description" content="Unboxing like never before. Because it <i>hits different</i>.">

    <link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>    /* ===== UNIFIED DESIGN SYSTEM ===== */
        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            color: var(--primary);
            text-decoration: none;
            font-family: 'Cinzel', serif;
            font-size: 1.75rem;
            font-weight: 700;
            text-shadow: 0 0 20px rgba(191, 151, 255, 0.5);
            position: relative;
        }

        .logo::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #bf97ff, transparent);
        }

        .logo-icon {
            color: var(--accent);
            font-size: 2rem;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.5));
        }

        .nav-links {
            margin-left: auto;
            display: flex;
            gap: 3rem;
        }

        .nav-links a {

    color: var(--primary);
            text-decoration: none;
            position: relative;
            padding: 0.5rem 0;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            /*font-size: 1rem;*/
            transition: color 0.3s ease;
        }

        .nav-links a:hover {
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 2px;
            transition: width 0.3s ease;
        }

        .nav-links a:hover::after {
            width: 100%;
        }

    .logo-icon h1::after {
        content: '';
        position: absolute;
        bottom: -15px;
        left: 50%;
        transform: translateX(-50%);
        width: 200px;
        height: 2px;
        background: linear-gradient(90deg, transparent, #bf97ff, transparent);
    }
        .container {
            gap: 3rem;
            max-width: 1800px;
            margin: 0 auto;
        }

        .sidebar {
            width: 320px;
            flex-shrink: 0;
        }

        .user-info {
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .username {
            font-family: 'Cinzel', serif;
            font-size: 1.75rem;
            color: var(--primary);
            margin-bottom: 0.75rem;
            text-shadow: 0 0 10px rgba(191, 151, 255, 0.5);
        }

        .user-stats {
            display: flex;
            justify-content: center;
            gap: 1rem;
            font-size: 1rem;
        }

        .user-stat {
            background: rgba(191, 151, 255, 0.1);
            padding: 0.75rem 1.25rem;
            border-radius: 20px;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border: 1px solid var(--primary);
        }

        .user-stat-icon {
            font-size: 1.5rem;
        }

        .filters {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02));
            border-radius: 16px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .filters h2, .collection-title {
            color: var(--primary);
            font-size: 1.75rem;
            margin-bottom: 1.5rem;
            font-family: 'Cinzel', serif;
            text-align: center;
            position: relative;
            text-shadow: 0 0 10px rgba(191, 151, 255, 0.3);
        }

        .filters h2::after, .collection-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #bf97ff, transparent);
        }

        .search-box {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 1rem;
            width: 100%;
            color: var(--text);
            margin-bottom: 2rem;
            transition: all 0.3s ease;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
        }

        .search-box:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
        }

        .type-select {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid var(--primary);
            border-radius: 8px;
            padding: 1rem;
            width: 100%;
            color: var(--text);
            margin-bottom: 2rem;
            cursor: pointer;
            font-family: 'Cormorant Garamond', serif;
            font-size: 1.1rem;
        }

        .view-collection {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            background: linear-gradient(45deg, rgba(191, 151, 255, 0.2), rgba(191, 151, 255, 0.1));
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1rem;
            border-radius: 8px;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }

        .view-collection::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.2) 0%, transparent 70%);
            transition: transform 0.5s ease;
        }

        .view-collection:hover::before {
            transform: translate(25%, 25%);
        }

        .view-collection:hover {
            background: linear-gradient(45deg, rgba(191, 151, 255, 0.3), rgba(191, 151, 255, 0.2));
            border-color: var(--accent);
            box-shadow: 0 0 30px rgba(191, 151, 255, 0.3);
            transform: translateY(-2px);
            color: var(--accent);
        }

    :root {
        /* Primary Colors */
        --primary: #00e5ff;
        --primary-dark: #00b8d4;
        --primary-light: #18ffff;
        --primary-glow: rgba(0, 229, 255, 0.5);

        /* Secondary Colors */
        --secondary: #ff0055;
        --secondary-dark: #c6004e;
        --secondary-light: #ff4081;

        /* Accent Colors */
        --accent: #7c4dff;
        --accent-dark: #651fff;
        --accent-light: #b388ff;

        /* Background Colors */
        --bg-dark: #0a0e17;
        --bg-darker: #050a14;
        --bg-card: rgba(16, 23, 41, 0.85);
        --bg-card-hover: rgba(20, 29, 49, 0.9);
        --bg-glass: rgba(255, 255, 255, 0.05);

        /* Text Colors */
        --text-primary: #ffffff;
        --text-secondary: rgba(255, 255, 255, 0.8);
        --text-disabled: rgba(255, 255, 255, 0.5);
        --text-hint: rgba(255, 255, 255, 0.3);

        /* Status Colors */
        --success: #00e676;
        --warning: #ffea00;
        --error: #ff1744;
        --info: #2979ff;

        /* Card Rarity Colors */
        --gold: #ffd700;
        --platinum: #e5e4e2;
        --emerald: #50c878;
        --diamond: #b9f2ff;

        /* Border & Shadow */
        --border-light: rgba(255, 255, 255, 0.1);
        --border-medium: rgba(255, 255, 255, 0.2);
        --shadow-soft: 0 4px 20px rgba(0, 0, 0, 0.3);
        --shadow-medium: 0 8px 30px rgba(0, 0, 0, 0.4);
        --shadow-hard: 0 12px 40px rgba(0, 0, 0, 0.5);
        --shadow-glow: 0 0 20px var(--primary-glow);

        /* Transitions */
        --transition-fast: 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        --transition-medium: 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        --transition-slow: 0.5s cubic-bezier(0.4, 0, 0.2, 1);

        /* Spacing */
        --spacing-xs: 0.5rem;
        --spacing-sm: 0.3rem;
        --spacing-md: 1.5rem;
        --spacing-lg: 2rem;
        --spacing-xl: 3rem;

        /* Border Radius */
        --radius-sm: 8px;
        --radius-md: 12px;
        --radius-lg: 16px;
        --radius-xl: 24px;
    }

    /* ===== GLOBAL STYLES ===== */

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: "Rajdhani", sans-serif;
        background: linear-gradient(135deg, var(--bg-darker) 0%, var(--bg-dark) 100%);
        color: var(--text-primary);
        min-height: 100vh;
        overflow-x: hidden;
        line-height: 1.6;
    }

    /* Custom Scrollbar */
    ::-webkit-scrollbar {
        width: 8px;
        height: 8px;
    }

    ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb {
        background: linear-gradient(45deg, var(--primary-dark), var(--primary));
        border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
        background: linear-gradient(45deg, var(--primary), var(--primary-light));
    }

    /* ===== UNIFIED CARD SYSTEM ===== */

    .unified-card {
        background: var(--bg-card);
        border: 1px solid var(--border-light);
        border-radius: var(--radius-lg);
        backdrop-filter: blur(20px);
        box-shadow: var(--shadow-medium);
        transition: all var(--transition-medium);
        position: relative;
        overflow: hidden;
    }

    .unified-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg,
            transparent 0%,
            rgba(255, 255, 255, 0.05) 50%,
            transparent 100%);
        opacity: 0;
        transition: opacity var(--transition-medium);
        pointer-events: none;
    }

    .unified-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-hard), var(--shadow-glow);
        border-color: var(--primary);
    }

    .unified-card:hover::before {
        opacity: 1;
    }

    /* ===== UNIFIED BUTTON SYSTEM ===== */

    .btn-unified {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: var(--spacing-xs);
        padding: var(--spacing-sm) var(--spacing-md);
        border: none;
        border-radius: var(--radius-md);
        font-family: inherit;
        font-weight: 600;
        text-decoration: none;
        cursor: pointer;
        transition: all var(--transition-medium);
        position: relative;
        overflow: hidden;
        white-space: nowrap;
    }

    .btn-unified::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg,
            transparent,
            rgba(255, 255, 255, 0.2),
            transparent);
        transition: left var(--transition-slow);
    }

    .btn-unified:hover::before {
        left: 100%;
    }

    .btn-primary {
        background: linear-gradient(45deg, var(--primary-dark), var(--primary));
        color: var(--bg-dark);
        box-shadow: 0 4px 15px rgba(0, 229, 255, 0.3);
    }

    .btn-primary:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 229, 255, 0.4);
    }

    .btn-secondary {
        background: var(--bg-glass);
        color: var(--text-primary);
        border: 1px solid var(--border-medium);
    }

    .btn-secondary:hover {
        background: rgba(255, 255, 255, 0.1);
        border-color: var(--primary);
        color: var(--primary);
    }



        :root {
            --background: #0a0a13;
            --foreground: #e0e0e0;
            --primary: #bf97ff;
            --secondary: #ff6b6b;
            --accent: #4ecca3;
            --card-bg: #1a1a2e;
            --glow-primary: 0 0 15px rgba(191, 151, 255, 0.7);
            --glow-accent: 0 0 15px rgba(78, 204, 163, 0.7);
            --border-gradient: linear-gradient(135deg, #bf97ff, #4ecca3);
            --border-gradient: linear-gradient(135deg, rgb(191, 151, 255, 0.2), rgb(78, 204, 163, 0.2));
            --sidebar-width: 320px;
            --sidebar-collapsed-width: 80px;
            --bg-light: linear-gradient(to right, #91EAE4, #86A8E7, #7F7FD5);
            --bg-dark: #050510;
            --radial-light: none;
            --radial-dark: radial-gradient(circle at 20% 35%, rgba(0, 240, 255, 0.15) 0%, transparent 40%), radial-gradient(circle at 75% 65%, rgba(255, 0, 229, 0.15) 0%, transparent 40%);

        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Rajdhani', 'Orbitron', sans-serif;
        }

        body {
            background: linear-gradient(to right, #91EAE4, #86A8E7, #7F7FD5);

            transition: background 0.5s ease-in-out;
        }

        .dark-mode {
            background: var(--bg-dark) !important;
            background-image: var(--radial-dark) !important;
        }

        .buttonets {
            top: 20px;
            left: 20px;
            padding: 10px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 13rem;
            overflow: hidden;
            height: 3rem;
            background-size: 300% 300%;
            cursor: pointer;
            backdrop-filter: blur(1rem);
            border-radius: 5rem;
            transition: 0.5s;
            animation: gradient_301 5s ease infinite;
            border: double 4px transparent;
            margin-bottom: -30px;
            background: rgba(0, 0, 0, 0.2);
        }

        #containerteed-stars {
          position: absolute;
          z-index: -1;
          width: 100%;
          height: 100%;
          overflow: hidden;
          transition: 0.5s;
          backdrop-filter: blur(1rem);
          border-radius: 5rem;
        }

        strong {
          z-index: 2;
          font-family: "Avalors Personal Use";
          font-size: 12px;
          letter-spacing: 5px;
          color: #ffffff;
          text-shadow: 0 0 4px white;
        }

        #glow {
          position: absolute;
          display: flex;
          width: 12rem;
        }

        .circle {
          width: 100%;
          height: 30px;
          filter: blur(2rem);
          animation: pulse_3011 4s infinite;
          z-index: -1;
        }

        .circle:nth-of-type(1) {
          background: rgba(254, 83, 186, 0.636);
        }

        .circle:nth-of-type(2) {
          background: rgba(142, 81, 234, 0.704);
        }

        .buttonets:hover #containerteed-stars {
          z-index: 1;
          background-color: #212121;
        }

        .buttonets:hover {
          transform: scale(1.1);
        }

        .buttonets:active {
          border: double 4px #fe53bb;
          background-origin: border-box;
          background-clip: content-box, border-box;
          animation: none;
        }

        .buttonets:active .circle {
          background: #fe53bb;
        }

        #stars {
          position: relative;
          background: transparent;
          width: 200rem;
          height: 200rem;
        }

        #stars::after {
          content: "";
          position: absolute;
          top: -10rem;
          left: -100rem;
          width: 100%;
          height: 100%;
          animation: animStarRotate 90s linear infinite;
        }

        #stars::after {
          background-image: radial-gradient(#ffffff 1px, transparent 1%);
          background-size: 50px 50px;
        }

        #stars::before {
          content: "";
          position: absolute;
          top: 0;
          left: -50%;
          width: 170%;
          height: 500%;
          animation: animStar 60s linear infinite;
        }

        #stars::before {
          background-image: radial-gradient(#ffffff 1px, transparent 1%);
          background-size: 50px 50px;
          opacity: 0.5;
        }

        @keyframes animStar {
          from {
            transform: translateY(0);
          }

          to {
            transform: translateY(-135rem);
          }
        }

        @keyframes animStarRotate {
          from {
            transform: rotate(360deg);
          }

          to {
            transform: rotate(0);
          }
        }

        @keyframes gradient_301 {
          0% {
            background-position: 0% 50%;
          }

          50% {
            background-position: 100% 50%;
          }

          100% {
            background-position: 0% 50%;
          }
        }

        @keyframes pulse_3011 {
          0% {
            transform: scale(0.75);
            box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.7);
          }

          70% {
            transform: scale(1);
            box-shadow: 0 0 0 10px rgba(0, 0, 0, 0);
          }

          100% {
            transform: scale(0.75);
            box-shadow: 0 0 0 0 rgba(0, 0, 0, 0);
          }
        }

        .copyright-section {
            background: linear-gradient(to right, rgba(191, 151, 255, 0.1), rgba(255, 255, 255, 0.05), rgba(191, 151, 255, 0.1));
            width: 100%;
            position: fixed;
            bottom: 0;
            padding: 1rem 0;
            text-align: center;
            z-index: 100;
        }

        .main-menu {
            align-items: center;
            padding: 1rem 2rem;
            background: linear-gradient(
                to right,
                rgba(191, 151, 255, 0.1),
                rgba(255, 255, 255, 0.05),
                rgba(191, 151, 255, 0.1)
            );
            backdrop-filter: blur(10px);
            position: fixed;
            top: 0;
            z-index: 100;
            width: 100%;
            border-bottom: 1px solid rgba(191, 151, 255, 0.3);
        }

        .nav-links {
            left: 100px;
            display: flex;
            position: relative;
            gap: 3rem;
        }

        .nav-links h1 {
            position: relative;
        }

        a {
            text-decoration: none;
            color: inherit;
        }

        .navLogo {
            background-size: 100% auto;
            background-position: center;
            background-repeat: no-repeat;
            height: 2.3em;
            width: 2.5em;
        }

        .sidebar-container {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: var(--sidebar-width);
            z-index: 1000;
            transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1), width 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            background: linear-gradient(180deg, #0a0a13 0%, #12121f 100%);
            box-shadow: 5px 0 20px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            border-right: 1px solid rgba(191, 151, 255, 0.2);
            color: white;
        }

        .sidebar-hidden {
            transform: translateX(calc(-1 * var(--sidebar-width)));
        }

        .sidebar-collapsed {
            width: var(--sidebar-collapsed-width);
        }

        .sidebar {
            height: 100%;
            width: 100%;
            padding: 0;
            overflow-y: auto;
            overflow-x: hidden;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--background);
        }

        .sidebar::-webkit-scrollbar {
            width: 5px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(10, 10, 19, 0.5);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 10px;
        }

        .sidebar-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: rgba(10, 10, 19, 0.8);
            color: var(--primary);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 0 10px rgba(191, 151, 255, 0.3);
            backdrop-filter: blur(5px);
            border: 1px solid rgba(191, 151, 255, 0.3);
        }

        .sidebar-toggle:hover {
            background: rgba(191, 151, 255, 0.2);
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(191, 151, 255, 0.5);
        }

        .sidebar-toggle.active {
            left: calc(var(--sidebar-width) - 60px);
        }

        .sidebar-toggle.collapsed {
            left: calc(var(--sidebar-collapsed-width) - 60px);
        }


    .user-profile {
        position: relative;
        margin-bottom: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        background: linear-gradient(135deg, rgba(191, 151, 255, 0.1), rgba(10, 10, 19, 0.9));
        border-bottom: 1px solid rgba(191, 151, 255, 0.2);
        overflow: hidden;
        padding-bottom: 0px;
        height: 30%;
    }

        .user-profile::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--border-gradient);
        }

        .user-profile::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(191, 151, 255, 0.1), transparent);
            background-image: url("{% static 'css/images/a.jpg' %}");
        }

        .profile-picture {
            position: relative;
            width: 90px;
            height: 90px;
            border-radius: 50%;
            margin-bottom: 15px;
            border: 2px solid transparent;
            background: var(--border-gradient);
            padding: 2px;
            transition: all 0.3s ease;
            margin-left: auto;
            margin-right: auto;
            margin-top: 25px;
        }

        .profile-picture:hover {
            transform: scale(1.05);
            box-shadow: var(--glow-primary);
        }

        .profile-picture img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .profile-picture::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -5px;
            right: -5px;
            bottom: -5px;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(191, 151, 255, 0.1), rgba(78, 204, 163, 0.1));
            background-image: var(--profile-bg-image);
            z-index: -1;
            animation: pulse 2s infinite;
        }

        .level-badge {
            position: absolute;
            z-index: 200;
            bottom: -5px;
            right: -5px;
            background: var(--card-bg);
            color: var(--accent);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 2px solid var(--accent);
            box-shadow: 0 0 10px rgba(78, 204, 163, 0.5);
            font-size: 14px;
        }

        .user-info {
            text-align: center;
            width: 100%;
        }

        .username {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(191, 151, 255, 0.5);
            position: relative;
            display: inline-block;
        }

        .username::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 100%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
        }

        .user-stats {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 15px;
        }

        .user-stat {
            background: rgba(10, 10, 19, 0.6);
            padding: 8px 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(191, 151, 255, 0.3);
            transition: all 0.3s ease;
        }

        .user-stat:hover {
            transform: translateY(-3px);
            box-shadow: var(--glow-primary);
            border-color: var(--primary);
        }

        .user-stat::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(191, 151, 255, 0.1), transparent);
            z-index: -1;
        }

        .user-stat-icon {
            font-size: 1.2rem;
        }

        .sidebar-nav {
            padding: 0;
            margin-bottom: 20px;
        }

        .nav-section {
            margin-bottom: 20px;
        }

        .section-title {
            padding: 10px 20px;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--primary);
            position: relative;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::after {
            content: '';
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, var(--primary), transparent);
        }

        .section-title i {
            color: var(--accent);
            font-size: 1.1rem;
        }

        .nav-item {
            list-style: none;
            transition: all 0.3s ease;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            text-decoration: none;
            color: var(--foreground);
            position: relative;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            gap: 15px;
        }

        .linker {
            background: rgb(23, 207, 177, 10%);
            color: var(--primary);
            border-left-color: var(--primary);
        }
        .nav-link:hover {
            background: rgba(191, 151, 255, 0.1);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-link.active {
            background: linear-gradient(90deg, rgba(191, 151, 255, 0.2), transparent);
            color: var(--primary);
            border-left-color: var(--primary);
        }

        .nav-link i {
            font-size: 1.2rem;
            min-width: 25px;
            text-align: center;
            color: var(--primary);
            transition: all 0.3s ease;
        }

        .nav-link:hover i {
            transform: translateX(3px);
            color: var(--accent);
        }

        .nav-link .nav-text {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .nav-badge {
            background: var(--secondary);
            color: var(--foreground);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .nav-section .section-title {
          cursor: pointer;
          user-select: none;
          display: flex;
          align-items: center;
        }

        .nav-section .section-content {
          max-height: 100vh;
          overflow: hidden;
          transition: max-height 0.3s ease;
        }

        .nav-section.collapsed .section-content {
          max-height: 0;
        }

        .nav-section .section-title {
          display: flex;
          align-items: center;
          justify-content: space-between;
          cursor: pointer;
          user-select: none;
        }

        .nav-section .section-content {
          max-height: 100vh;
          overflow: hidden;
          transition: max-height 0.4s ease;
        }

        .nav-section.collapsed .section-content {
          max-height: 0;
        }

        .toggle-icon {
          transition: transform 0.3s ease;
        }

        .nav-section.collapsed .toggle-icon {
          transform: rotate(-90deg);
        }

        .collection {
            padding: 0 20px 20px;
        }

        .collection-title {
            color: var(--primary);
            font-size: 1.2rem;
            margin-bottom: 15px;
            text-align: center;
            position: relative;
            padding-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .collection-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 50%;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--primary), transparent);
        }

        .view-collection {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            background: linear-gradient(45deg, rgba(191, 151, 255, 0.2), rgba(191, 151, 255, 0.1));
            border: 2px solid var(--primary);
            color: var(--text);
            padding: 1rem;
            border-radius: 8px;
            width: 100%;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Cinzel', serif;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-size: 1.1rem;
            position: relative;
            overflow: hidden;
        }

        .view-collection::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.2) 0%, transparent 70%);
            transition: transform 0.5s ease;
        }

        .view-collection:hover::before {
            transform: translate(25%, 25%);
        }

        .view-collection:hover {
            background: linear-gradient(45deg, rgba(191, 151, 255, 0.3), rgba(191, 151, 255, 0.2));
            border-color: var(--accent);
            box-shadow: 0 0 30px rgba(191, 151, 255, 0.3);
            transform: translateY(-2px);
            color: var(--accent);
        }

        .view-collection i {
            font-size: 1.2rem;
            color: var(--accent);
        }

        .progress-section {
            padding: 0 20px 20px;
        }

        .progress-title {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 0.9rem;
            color: var(--foreground);
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--accent));
            border-radius: 4px;
            position: relative;
            transition: width 1s ease;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100%;
            background: var(--foreground);
            border-radius: 0 4px 4px 0;
        }

        .sidebar-collapsed .nav-text,
        .sidebar-collapsed .username,
        .sidebar-collapsed .user-stats,
        .sidebar-collapsed .section-title::after,
        .sidebar-collapsed .collection-title::after,
        .sidebar-collapsed .progress-section,
        .sidebar-collapsed .nav-badge {
            display: none;
        }

        .sidebar-collapsed .profile-picture {
            width: 50px;
            height: 50px;
            margin: 10px auto;
        }

        .sidebar-collapsed .user-profile {
            padding: 10px;
        }

        .sidebar-collapsed .section-title {
            justify-content: center;
            padding: 10px 0;
        }

        .sidebar-collapsed .nav-link {
            justify-content: center;
            padding: 15px 0;
            border-left: none;
            border-bottom: 3px solid transparent;
        }

        .sidebar-collapsed .nav-link:hover,
        .sidebar-collapsed .nav-link.active {
            border-left: none;
            border-bottom-color: var(--primary);
        }

        .sidebar-collapsed .nav-link i {
            font-size: 1.5rem;
            margin: 0;
        }

        .sidebar-collapsed .view-collection {
            padding: 12px 0;
            justify-content: center;
        }

        .sidebar-collapsed .view-collection span {

        }

        @keyframes pulse {
            0% {
                opacity: 0.6;
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                transform: scale(1.05);
            }
            100% {
                opacity: 0.6;
                transform: scale(1);
            }
        }

        @keyframes glow {
            0% {
                box-shadow: 0 0 5px rgba(191, 151, 255, 0.5);
            }
            50% {
                box-shadow: 0 0 20px rgba(191, 151, 255, 0.8);
            }
            100% {
                box-shadow: 0 0 5px rgba(191, 151, 255, 0.5);
            }
        }

        .main-content {
            transition: margin-left 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        .main-content-expanded {
            margin-left: var(--sidebar-collapsed-width);
        }

        .main-menu {
			position: fixed;
            align-items: center;
            padding: 1rem 2rem;
            background: linear-gradient(90deg, rgba(0, 240, 255, 0.1), rgba(255, 0, 229, 0.05));
            backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(0, 240, 255, 0.2);
            top: 0;
            z-index: 100;
        }

    nav.main-menu ul li a {
        color: #fff;
        font-weight: 700;
        display: block;
        padding: 15px;
    }

    .button-85 {
      padding: 0.6em 2em;
      border: none;
      outline: none;
      color: rgb(255, 255, 255);
      background: #111;
      cursor: pointer;
      position: relative;
      z-index: 0;
      border-radius: 10px;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
    }

    .button-85:before {
      content: "";
      background: linear-gradient(
        45deg,
        #ff0000,
        #ff7300,
        #fffb00,
        #48ff00,
        #00ffd5,
        #002bff,
        #7a00ff,
        #ff00c8,
        #ff0000
      );
      position: absolute;
      top: -2px;
      left: -2px;
      background-size: 400%;
      z-index: -1;
      filter: blur(5px);
      -webkit-filter: blur(5px);
      width: calc(100% + 4px);
      height: calc(100% + 4px);
      animation: glowing-button-85 20s linear infinite;
      transition: opacity 0.3s ease-in-out;
      border-radius: 10px;
    }

    @keyframes glowing-button-85 {
      0% {
        background-position: 0 0;
      }
      50% {
        background-position: 400% 0;
      }
      100% {
        background-position: 0 0;
      }
    }

    .button-85:after {
      z-index: -1;
      content: "";
      position: absolute;
      width: 100%;
      height: 100%;
      background: #222;
      left: 0;
      top: 0;
      border-radius: 10px;
    }

             #visual-mode-text {
        color: #0a0a13;
        transition: color 0.3s ease;
      }

      .buttonets:hover #visual-mode-text {
        color: white;
      }

        @media (max-width: 768px) {
            .copyright-section {
                display: none;
            }

    .form-header {
        text-align: center;
        margin-bottom: 2rem;
        animation: slideDown 0.6s ease-out;
    }

    .form-header h1 {
        color: var(--primary);
        font-size: 2.0rem;
        margin-bottom: 0.5rem;
        transform: translate(0px, 0px);
        text-transform: uppercase;
        text-align: center;
        ng: 2px;
        text-shadow: 0 0 20px rgba(0, 240, 255, 0.5);
    }
    .form-content {
        animation: fadeIn 0.8s ease-out;
    }
        .container {
            width: 80%;
            max-width: 800px;
            padding: 20px;
            background-color: #2a2a40;
            border-radius: 10px;
        }

        .notification-bar {
            border-radius: 8px;
            padding: 15px 30px;
            color: white;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border-bottom: 2px solid #2d3748;
            background: linear-gradient(135deg, #4a5568 0%, #2d3748 100%);
            position: relative;
            overflow: hidden;
            min-height: 120px;
            max-width: 600px;
            margin: 0 auto;
        }

        .notification-content {
            position: relative;
            z-index: 10;
            width: 100%;
        }

        .inner-section {
            display: flex;
            flex-direction: row;
            padding: 5px;
            justify-content: space-between;
            align-items: center;
        }

        .left-section {
            display: flex;
            flex-direction: column;
        }

        .title-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .title {
            font-size: 20px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .dot {
            width: 8px;
            height: 8px;
            background-color: #38b2f8;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .subtitle {
            font-size: 16px;
            color: #a0aec0;
            margin-top: 4px;
        }

        .right-section {
            display: flex;
            align-items: center;
            margin-left: 10px;
            gap: 15px;
        }

        .ruby-count {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #2d3748;
            padding: 8px 15px;
            border-radius: 6px;
        }

        .ruby-icon {
            color: #38b2f8;
            font-size: 20px;
        }

        .count {
            font-size: 18px;
            font-weight: bold;
        }

        .info-icon {
            width: 24px;
            height: 24px;
            background-color: #2d3748;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
        }

        .tooltip {
            position: absolute;
            top: 30px;
            right: 0;
            width: 150px;
            background-color: #2d3748;
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-size: 14px;
            display: none;
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .info-icon:hover .tooltip {
            display: block;
        }

        .bubble {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            pointer-events: none;
            z-index: 1;
        }

        .bubble::before {
            content: '';
            position: absolute;
            top: 10%;
            left: 10%;
            width: 30%;
            height: 30%;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            filter: blur(2px);
        }

        .bubble.small {
            width: 15px;
            height: 15px;
        }

        .bubble.medium {
            width: 25px;
            height: 25px;
        }

        .bubble.large {
            width: 35px;
            height: 35px;
        }

          #ruby-drop-btn.clicked {
    background-color: #718096;
    cursor: not-allowed;
    opacity: 0.7;
  }
    .volume {
  display: flex;
  justify-content: center;
  align-items: center;
}
.volume input[type=range] {
  display: none;
}
.volume .icon-size {
  font-size: 2rem;
}
.volume .bar-hoverbox {
  padding: 10px 15px;
  opacity: 0.7;
  transition: opacity 0.2s;
}
.volume .bar-hoverbox:hover {
  opacity: 1;
  cursor: pointer;
}
.volume .bar {
  background: #999;
  height: 7px;
  width: 120px;
  border-radius: 15px;
  overflow: hidden;
  pointer-events: none;
}
.volume .bar .bar-fill {
  background: #FFF;
  width: 0%;
  height: 100%;
  background-clip: border-box;
  pointer-events: none;
}
    .volume-value {
  display: inline-block;
  width: 2ch;
  text-align: center;
  font-weight: bold;
}
</style>

</head>
<body>
<script>
document.addEventListener('DOMContentLoaded', () => {

  function getCookie(name) {
    let cookie = null;
    if (document.cookie && document.cookie !== '') {
      document.cookie.split(';').forEach(c => {
        const [k, v] = c.trim().split('=');
        if (k === name) cookie = decodeURIComponent(v);
      });
    }
    return cookie;
  }
  const csrftoken = getCookie('csrftoken');
  console.log('CSRF token is:', csrftoken);

  let RD_MULTIPLIER = 1;
function fetchAndUpdateMultiplier() {
  fetch("{% url 'showcase:ajax_update_amount' %}")
    .then(resp => {
      if (!resp.ok) {
        // If the server returned 4xx/5xx, treat it like an error
        throw new Error(`HTTP ${resp.status}`);
      }
      return resp.json();
    })
    .then(data => {
      if (data && data.rd_multiplier !== undefined) {
        RD_MULTIPLIER = parseFloat(data.rd_multiplier);
      } else {
        // If the payload doesn‚Äôt include rd_multiplier, default
        RD_MULTIPLIER = 1;
      }

      // Update the visible display, if present
      const displayEl = document.getElementById('rd-multiplier-display');
      if (displayEl) {
        displayEl.textContent = RD_MULTIPLIER.toFixed(2);
      }
    })
    .catch(err => {
      console.warn("Could not fetch rd_multiplier:", err);
      // **FALL BACK TO 1 ON ANY ERROR**
      RD_MULTIPLIER = 1;

      // Also update the display element to show ‚Äú1.00‚Äù if it exists:
      const displayEl = document.getElementById('rd-multiplier-display');
      if (displayEl) {
        displayEl.textContent = (1).toFixed(2);
      }
    });
}

  fetchAndUpdateMultiplier();

  setInterval(fetchAndUpdateMultiplier, 30000);

  const rubyBtn   = document.getElementById('ruby-drop-btn');
  const timerEl   = document.getElementById('hourly-timer');
  const rubySound = document.getElementById('ruby-sound');
  console.log('Button found?', !!rubyBtn);

  const INTERVAL_MS = 30 * 60 * 1000;

function getIntervalStart() {
    return Math.floor(Date.now() / INTERVAL_MS) * INTERVAL_MS;
  }

  // Initialize:
  let currentIntervalStart = getIntervalStart();
  let dropFired = false;
  window.dropAmount = Math.floor(Math.random() * 15) + 1;

  function handleIntervalRollover(prevStart) {
    const clickKey    = 'rubyClicks_' + prevStart;
    const totalClicks = parseInt(localStorage.getItem(clickKey), 10) || 0;

    console.log(`handleIntervalRollover ‚Äì window start ${prevStart}: totalClicks = ${totalClicks}`);

    let reward;
    if (totalClicks < 100) {
      reward = Math.floor(Math.random() * (25 - 16 + 1)) + 1;
    } else {
      reward = Math.round(2500 / totalClicks);
    }

    window.dropAmount = reward;
    console.log(`Calculated reward from ${totalClicks} clicks ‚Üí dropAmount = ${reward}`);

    // Once we‚Äôve computed it, clear that old‚Äêinterval counter
    localStorage.removeItem(clickKey);
    return reward;
  }


   function updateCountdown() {
    const now   = Date.now();
    const start = getIntervalStart();

    if (start !== currentIntervalStart) {
      // The interval truly just rolled over (not our ‚Äúon‚Äêload‚Äù calculation)
      const prevStart = currentIntervalStart;
      console.log(`üîÑ Interval rolled over. Previous window started at ${new Date(prevStart).toISOString()}`);
      handleIntervalRollover(prevStart);

      // Reset the ‚ÄúClaim‚Äù button for the new interval
      if (rubyBtn) {
        rubyBtn.classList.remove('clicked');
        rubyBtn.disabled = false;
        rubyBtn.textContent = 'Ruby Drop';
      }

      currentIntervalStart = start;
      dropFired = false;
    }

    const elapsed     = now - start;
    const remainingMs = INTERVAL_MS - elapsed;
    const totalSec    = Math.max(0, Math.ceil(remainingMs / 1000));
    const mins = Math.floor(totalSec / 60);
    const secs = totalSec % 60;
    if (timerEl) {
      timerEl.textContent = `${pad(mins)}:${pad(secs)}`;
    }

    if (rubyBtn) {
      rubyBtn.style.display = (totalSec > 0 && totalSec < 120)
        ? 'inline-block'
        : 'none';
    }

    if (!dropFired && totalSec === 0) {
      const prevStart = start - INTERVAL_MS;
      const drop = handleIntervalRollover(prevStart);
      dropFired = true;
      const clicked = localStorage.getItem('rubyClickedInterval') === prevStart.toString();
      console.log(`üíé Drop: ${drop}. User ${clicked ? 'did' : 'did NOT'} click.`);
    }
  }

  function pad(n) {
    return n.toString().padStart(2, '0');
  }

  if (rubyBtn) {
    rubyBtn.addEventListener('click', () => {
      console.log('üîò Click handler start');
      console.log('window.dropAmount =', window.dropAmount);

      const start = getIntervalStart().toString();
      if (localStorage.getItem('rubyClickedInterval') === start) {
        console.log('Already clicked this interval, ignoring.');
        return;
      }

      localStorage.setItem('rubyClickedInterval', start);
      const clickKey = 'rubyClicks_' + start;
      const prev     = parseInt(localStorage.getItem(clickKey), 10) || 0;
      localStorage.setItem(clickKey, prev + 1);

      rubyBtn.classList.add('clicked');
      rubyBtn.disabled = true;
      rubyBtn.textContent = 'Claimed!';
      if (rubySound) {
        rubySound.currentTime = 0;
        rubySound.play().catch(() => {});
      }

      const url = "{% url 'showcase:claim-ruby' %}";
      console.log('Will POST to:', url);
      console.log('About to call fetch‚Ä¶');
      fetch(url, {
        method: 'POST',
        credentials: 'same-origin',
        headers: {
          'Content-Type': 'application/json',
          'X-CSRFToken': csrftoken,
        },
        body: JSON.stringify({ dropAmount: window.dropAmount })
      })
      .then(resp => {
        console.log('‚Ü™Ô∏è fetch resolved, status:', resp.status);
        return resp.json();
      })
      .then(data => {
        console.log('üì¨ Response JSON:', data);
        if (data.newAmount !== undefined) {
          const multiplier = RD_MULTIPLIER;
          const newAmount  = (data.newAmount || 0) * multiplier;
          console.log('the multiplier is: ' + multiplier);

          const currencyEl = document.getElementById('currency-amount');
          if (currencyEl) {
            currencyEl.textContent = data.newAmount;
          }
          console.log('Final increase is ', (window.dropAmount) * (multiplier));
        }
      })
      .catch(err => console.error('‚ùå fetch error:', err));

      console.log('üîö Click handler end');
    });
  }

  updateCountdown();
  setInterval(updateCountdown, 1000);

  class BubbleAnimation {
    constructor(container) {
      this.container = container;
      this.bubbles = [];
      this.isRunning = false;
      this.init();
    }

    init() {
      this.startAnimation();
    }

    createBubble() {
      const bubble = document.createElement('div');
      bubble.className = 'bubble';

      const sizes = ['small', 'medium', 'large'];
      const randomSize = sizes[Math.floor(Math.random() * sizes.length)];
      bubble.classList.add(randomSize);

      const containerWidth = this.container.offsetWidth;
      const bubbleSize = randomSize === 'small' ? 20 : randomSize === 'medium' ? 35 : 50;
      const maxLeft = containerWidth - bubbleSize;
      const randomLeft = Math.random() * maxLeft;

      bubble.style.left = randomLeft + 'px';
      bubble.style.bottom = '-50px';

      const drift = (Math.random() - 0.5) * 100;
      bubble.style.setProperty('--drift', drift + 'px');

      const driftKeyframes = `
        @keyframes rise-${Date.now()} {
          0% {
            transform: translateY(0) translateX(0) rotate(0deg);
            opacity: 0;
          }
          10% {
            opacity: 1;
          }
          50% {
            transform: translateY(-50vh) translateX(${drift/2}px) rotate(180deg);
          }
          90% {
            opacity: 1;
          }
          100% {
            transform: translateY(-100vh) translateX(${drift}px) rotate(360deg);
            opacity: 0;
          }
        }
      `;

      const style = document.createElement('style');
      style.textContent = driftKeyframes;
      document.head.appendChild(style);

      bubble.style.animationName = `rise-${Date.now()}`;

      this.container.appendChild(bubble);
      this.bubbles.push(bubble);

      const animationDuration = randomSize === 'small' ? 8000 : randomSize === 'medium' ? 12000 : 15000;
      setTimeout(() => {
        if (bubble.parentNode) {
          bubble.parentNode.removeChild(bubble);
          document.head.removeChild(style);
        }
        this.bubbles = this.bubbles.filter(b => b !== bubble);
      }, animationDuration);
    }

    startAnimation() {
      if (this.isRunning) return;
      this.isRunning = true;

      this.createBubble();

      this.intervalId = setInterval(() => {
        this.createBubble();
      }, Math.random() * 2000 + 1000);
    }

    stopAnimation() {
      this.isRunning = false;
      if (this.intervalId) {
        clearInterval(this.intervalId);
      }
    }

    destroy() {
      this.stopAnimation();
      this.bubbles.forEach(bubble => {
        if (bubble.parentNode) {
          bubble.parentNode.removeChild(bubble);
        }
      });
      this.bubbles = [];
    }
  }

  document.addEventListener('DOMContentLoaded', function() {
    const notificationBar = document.getElementById('notificationBar');
    const bubbleAnimation = new BubbleAnimation(notificationBar);

    notificationBar.addEventListener('click', function() {
      if (bubbleAnimation.isRunning) {
        bubbleAnimation.stopAnimation();
        console.log('Bubble animation stopped');
      } else {
        bubbleAnimation.startAnimation();
        console.log('Bubble animation started');
      }
    });
  });
});
</script>

    <script>
        class BubbleAnimation {
            constructor(container) {
                this.container = container;
                this.bubbles = [];
                this.isRunning = false;
                this.animationCounter = 0;
                this.init();
            }

            init() {
                this.startAnimation();
            }

            createBubble() {
                const bubble = document.createElement('div');
                bubble.className = 'bubble';

                const sizes = ['small', 'medium', 'large'];
                const randomSize = sizes[Math.floor(Math.random() * sizes.length)];
                bubble.classList.add(randomSize);

                const bubbleSize = randomSize === 'small' ? 15 : randomSize === 'medium' ? 25 : 35;

                const containerRect = this.container.getBoundingClientRect();
                const containerWidth = this.container.offsetWidth;
                const maxLeft = containerWidth - bubbleSize;
                const randomLeft = Math.random() * Math.max(0, maxLeft);

                bubble.style.left = randomLeft + 'px';
                bubble.style.bottom = '-50px';

                const animationId = `rise-${this.animationCounter++}-${Date.now()}`;

                const drift = (Math.random() - 0.5) * 80;
                const containerHeight = this.container.offsetHeight;
                const totalDistance = containerHeight + 100;

                const keyframes = `
                    @keyframes ${animationId} {
                        0% {
                            transform: translateY(0) translateX(0) rotate(0deg);
                            opacity: 0;
                        }
                        10% {
                            opacity: 0.8;
                        }
                        50% {
                            transform: translateY(-${totalDistance/2}px) translateX(${drift/2}px) rotate(180deg);
                            opacity: 0.6;
                        }
                        90% {
                            opacity: 0.3;
                        }
                        100% {
                            transform: translateY(-${totalDistance}px) translateX(${drift}px) rotate(360deg);
                            opacity: 0;
                        }
                    }
                `;

                const style = document.createElement('style');
                style.textContent = keyframes;
                document.head.appendChild(style);

                const animationDuration = randomSize === 'small' ? 6 : randomSize === 'medium' ? 8 : 10;
                bubble.style.animation = `${animationId} ${animationDuration}s linear forwards`;

                this.container.appendChild(bubble);
                this.bubbles.push({ element: bubble, style: style });

                setTimeout(() => {
                    this.removeBubble(bubble, style);
                }, animationDuration * 1000);
            }

            removeBubble(bubbleElement, styleElement) {

                if (bubbleElement && bubbleElement.parentNode) {
                    bubbleElement.parentNode.removeChild(bubbleElement);
                }

                if (styleElement && styleElement.parentNode) {
                    styleElement.parentNode.removeChild(styleElement);
                }

                this.bubbles = this.bubbles.filter(b => b.element !== bubbleElement);
            }

            startAnimation() {
                if (this.isRunning) return;
                this.isRunning = true;

                this.createBubble();

                this.intervalId = setInterval(() => {
                    if (this.isRunning) {
                        this.createBubble();
                    }
                }, Math.random() * 1500 + 800);
            }

            stopAnimation() {
                this.isRunning = false;
                if (this.intervalId) {
                    clearInterval(this.intervalId);
                    this.intervalId = null;
                }
            }

            destroy() {
                this.stopAnimation();

                this.bubbles.forEach(bubble => {
                    this.removeBubble(bubble.element, bubble.style);
                });
                this.bubbles = [];
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const notificationBar = document.getElementById('notificationBar');

            if (notificationBar) {
                const bubbleAnimation = new BubbleAnimation(notificationBar);

                notificationBar.addEventListener('click', function() {
                    if (bubbleAnimation.isRunning) {
                        bubbleAnimation.stopAnimation();
                        console.log('Bubble animation stopped');
                    } else {
                        bubbleAnimation.startAnimation();
                        console.log('Bubble animation started');
                    }
                });

                window.addEventListener('beforeunload', function() {
                    bubbleAnimation.destroy();
                });
            } else {
                console.error('Notification bar element not found!');
            }
        });
    </script>
    <!-- Main Navigation -->
<!-- somewhere in <head> or just before </body> -->

<nav class="main-menu" style="z-index: 100;">
        <div class="nav-links">
<h1>
{% for logo in Logo %}
<!--    <a href="{{ logo.hyperlink }}" class="logo">-->
<!--      <img src="{{ logo.logocover.url }}">-->
<!--    </a>-->
     <a href="{{ logo.hyperlink }}" class="logo">
    <div class="navLogo" style="background-image: url('{{ logo.logocover.url }}');"></div>
     </a>
{% empty %}
    PokeTrove
{% endfor %}

</h1>

            <ul id="fullNavbar" style="display: flex; flex-direction: row; align-items: center;">
                {% for column in Header %}
                <li class="current-list-item" style="color: white;">
                    <a href="#{{ column.section }}" style="color: var(--light);
    text-decoration: none;
    font-weight: 600;
    font-size: 18px;
    letter-spacing: 1px;
    transition: all 0.3sease;">{{ column.text }}</a>
                    <ul class="sub-menu">
                        {% for row in DropDown %}
                            {% if row.row == column.row %}
                                {% if row.url == 'http://127.0.0.1:8000/profile' %}
                                    {% if row.opennew %}
                                        <li><a href="{{ profile_url }}" target="_blank">{{ row.text }}</a></li>
                                    {% else %}
                                        <li><a href="{{ profile_url }}">{{ row.text }}</a></li>
                                    {% endif %}
                                {% else %}
                                    {% if row.opennew %}
                                        <li><a href="{{ row.url }}" target="_blank">{{ row.text }}</a></li>
                                    {% else %}
                                        <li><a href="{{ row.url }}">{{ row.text }}</a></li>
                                    {% endif %}
                                {% endif %}
                            {% endif %}
                        {% endfor %}
                    </ul>
                </li>
                {% endfor %}
                <a href="{% url 'showcase:currencymarket' %}" style="margin-left: 25px;">
                    <button class="button-85" role="button" style="display: flex; flex-direction: row;"><i class="fas fa-gem user-stat-icon" style="color: #ED2221; margin-top: 4px;"></i>‚ûï</button>
                </a>
            </ul>
            <ul id="simpleNavbar" style="display: none; flex-direction: row; align-items: center;">
                {% for column in Header %}
                <li class="current-list-item" style="color: white;">
                    <a href="#{{ column.section }}">{{ column.text }}</a>
                </li>
                {% endfor %}
            </ul>
        </div>
    </nav>
    <!-- Sidebar Toggle Button -->
    <button id="sidebarToggle" class="sidebar-toggle">
        <i class="fas fa-bars"></i>
    </button>

    <!-- Sidebar -->
    <div class="sidebar-container sidebar-hidden">
        <aside class="sidebar">
            <!-- User Profile Section -->
             {% for userprofile in NewsProfiles %}

    <div class="user-profile">
    <br>
        <div class="profile-picture" style="--profile-bg-image: url('{{ userprofile.newprofile_profile_picture_url|default:'/static/css/images/a.jpg' }}');">
            <a href="{{ userprofile.newprofile_profile_url }}">
                <img src="{{ userprofile.newprofile_profile_picture_url|default:'/static/css/images/a.jpg' }}" alt="Profile Picture" style="border-radius: 50px; margin-right: 20px;" onerror="this.onerror=null; this.src='/static/css/images/a.jpg';">
                {% if userprofile.level.icon %}
                <div class="level-badge">{{ userprofile.level.icon }}</div>
                {% else %}
                <div class="level-badge">üëë</div>
                {% endif %}
            </a>
        </div>
            <h4 class="username">{{ user.username }}</h4>
        {% if request.user.is_authenticated and request.user.userstate.state == 0 %}
             <form method="post" action="{% url 'showcase:go_lootbox' %}">
              {% csrf_token %}
              <button class="buttonets" style="margin-left: auto; margin-right: auto; margin-top: 10px; margin-bottom: 10px;">
                <strong><h6 id="visual-mode-text">Lootbox</h6></strong>
                <div id="containerteed-stars">
                  <div id="stars"></div>
                </div>
                <div id="glow">
                  <div class="circle"></div>
                  <div class="circle"></div>
                </div>
              </button>
             </form>
        {% else %}
            <form method="post" action="{% url 'showcase:go_home' %}">
          {% csrf_token %}
          <button class="buttonets" style="margin-left: auto; margin-right: auto; margin-top: 10px;">
            <strong><h6 id="visual-mode-text">Home</h6></strong>
            <div id="containerteed-stars">
              <div id="stars"></div>
            </div>
            <div id="glow">
              <div class="circle"></div>
              <div class="circle"></div>
            </div>
          </button>
        </form>
        {% endif %}



        <style>
            .notification-bar {
  position: relative;
  overflow: hidden;
}

.sparks {
  position: absolute;
  bottom: 0; left: 0;
  width: 100%; height: 100%;
  pointer-events: none;
  z-index: 10;
}

.sparks .spark {
  position: absolute;
  bottom: 0;
  left: var(--left);

  width: 1px;
  height: 12px;

  box-shadow:
    -1px 0 3px var(--color),
     1px 0 3px var(--color);

  filter: blur(1px);
  opacity: 0;
  animation: rise var(--duration) ease-out infinite var(--delay);
}

@keyframes rise {
  0% {
    transform: translate(0, 0) scaleX(1);
    opacity: 1;
  }
  50% {

    transform: translate(var(--drift-x-mid, 0), -30px) scaleX(0.7);
    opacity: 0.8;
  }
  100% {

    transform: translate(var(--drift-x), -90px) scaleX(0.5);
    opacity: 0;
  }
}

        .info-icon {
            width: 24px;
            height: 24px;
            background-color: #2d3748;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
        }

        .info-icon span {
            font-size: 14px;
            font-weight: bold;
            color: #a0aec0;
        }

        .tooltip {
            position: absolute;
            right: 0;
            width: 150px;
            background-color: #2d3748;
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-size: 14px;
            display: none;
            z-index: 10;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.3s ease, display 0.3s ease;
        }

        .info-icon:hover .tooltip {
            display: block;
            opacity: 1;
        }

        .ruby-count {
            display: flex;
            align-items: center;
            gap: 8px;
            background-color: #2d3748;
            padding: 8px 15px;
            border-radius: 6px;
            position: relative;
            overflow: hidden;
        }

        .ruby-count.tier-B { border: none; }
        .ruby-count.tier-F { border: 2px solid white; }
        .ruby-count.tier-G { border: 2px solid green; }
        .ruby-count.tier-P { border: 2px solid yellow; }
        .ruby-count.tier-D { border: 2px solid orange; }
        .ruby-count.tier-W { border: 2px solid red; }
        .ruby-count.tier-BA { border: 2px solid black; }
        .ruby-count.tier-GT {
            border: 2px solid transparent;
            border-image: linear-gradient(to right, red, black) 1;
        }
        .ruby-count.tier-M {
            border: 2px solid transparent;
            border-image: linear-gradient(to right, red, gold) 1;
        }

        .ruby-count:not(.tier-B)::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(
                90deg,
                transparent,
                rgba(255, 255, 255, 0.8),
                transparent
            );
            border-radius: 8px;
            opacity: 0;
            animation: shine 2s infinite;
            pointer-events: none;
            z-index: 1;
        }

        .ruby-count:not(.tier-B)::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #2d3748;
            border-radius: 4px;
            z-index: 2;
            pointer-events: none;
        }

        .ruby-count > * {
            position: relative;
            z-index: 3;
        }

        @keyframes shine {
            0% {
                transform: translateX(-100%);
                opacity: 0;
            }
            50% {
                opacity: 1;
            }
            100% {
                transform: translateX(100%);
                opacity: 0;
            }
        }

        .ruby-icon {
            color: #38b2f8;
            font-size: 20px;
            display: flex;
            align-items: center;
        }

        .ruby-icon img {
            width: 25px;
            height: 25px;
            transform: translateY(15%);
        }

        .count {
            font-size: 18px;
            font-weight: bold;
            color: white;
        }

        </style>


    </div>
{% empty %}
    <div class="user-profile">

        <div class="user-info">
            <div class="profile-picture" style="--profile-bg-image: url('{{ userprofile.newprofile_profile_picture_url|default:'/static/css/images/a.jpg' }}');">
            <a href="{{ userprofile.newprofile_profile_url }}">
                <img src="{{ userprofile.newprofile_profile_picture_url|default:'/static/css/images/a.jpg' }}" alt="Profile Picture" style="border-radius: 50px; margin-right: 20px;" onerror="this.onerror=null; this.src='/static/css/images/a.jpg';">
                {% if userprofile.level.icon %}
                <div class="level-badge">{{ userprofile.level.icon }}</div>
                {% else %}
                <div class="level-badge">üëë</div>
                {% endif %}
            </a>
        </div>
            <h4 class="username">Guest</h4>
            <a href="{% url 'login' %}?next={% url 'showcase:currencymarket' %}" style="text-decoration: none;">

                </a>

         <div class="containerents" style="font-family: 'Arial', sans-serif; background-image: linear-gradient(#12121f 0%, #1a1a2e 100%); display: flex; flex-direction: row; justify-content: center; align-items: center; margin: 0;">
    <div class="notification-bar" style="border-radius: 8px; padding: 15px 30px; color: white; display: flex; flex-direction: column; justify-content: space-between; align-items: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); border-bottom: 2px solid #2d3748;" id="notificationBar">
        <div class="notification-content">
      <div class="inner-section" style="display: flex; flex-direction: row; padding: 5px;
            margin-top: 4% !important;">
        <div class="left-section" style="display: flex; flex-direction: column;">
          <div class="title-container" style="display: flex; align-items: center; gap: 10px;">
            <div class="title" style="font-size: 20px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;">INCOMING</div>

            <div class="dot"></div>
          </div>
          <div class="subtitle" style="font-size: 16px; color: #a0aec0; margin-top: 4px;">Ruby Drop</div>
        </div>

        <div class="right-section" style="display: flex; align-items: center; margin-left: 10px; gap: 15px;">
<div class="ruby-count tier-{{ user_tier_code }}"
  style="display: flex;
         align-items: center;
         gap: 8px;
         background-color: #2d3748;
         padding: 8px 15px;
         border-radius: 6px;">
  <div class="ruby-icon" style="color: #38b2f8; font-size: 20px;">
    <img src="/static/css/images/rubeye.png" style="width: 25px; height: 25px; transform: translate(0%, 15%); display: flex;">
  </div>
  <div class="count" id="ruby-count" style="font-size: 18px; font-weight: bold;">
    2,000
  </div>
</div>

    <div class="demo-section">
        <div class="info-icon">
            <div class="tooltip">
                Login for Ruby Multiplier

            </div>
            <span>i</span>
        </div>
    </div>
        </div>
          <div class="sparks">
  <div class="spark" style="--left: 5%;  --drift-x: -30px; --color: #fef68a; --duration: 2.5s; --delay: 0s;"></div>
  <div class="spark" style="--left: 15%; --drift-x:  25px; --color: #a0e9ff; --duration: 1.8s; --delay: 0.3s;"></div>
  <div class="spark" style="--left: 25%; --drift-x: -20px; --color: #ff9ae0; --duration: 2.2s; --delay: 0.6s;"></div>
  <div class="spark" style="--left: 35%; --drift-x:  40px; --color: #c3ff88; --duration: 3s;   --delay: 0.2s;"></div>
  <div class="spark" style="--left: 45%; --drift-x: -15px; --color: #ffd47e; --duration: 2.7s; --delay: 0.8s;"></div>
  <div class="spark" style="--left: 55%; --drift-x:  30px; --color: #ff6b6b; --duration: 1.9s; --delay: 0.4s;"></div>
  <div class="spark" style="--left: 65%; --drift-x: -35px; --color: #8bd3ff; --duration: 2.4s; --delay: 1s;"></div>
  <div class="spark" style="--left: 75%; --drift-x:  20px; --color: #d4b0ff; --duration: 2.1s; --delay: 0.5s;"></div>
  <div class="spark" style="--left: 85%; --drift-x: -25px; --color: #ffee93; --duration: 2.8s; --delay: 0.9s;"></div>
  <div class="spark" style="--left: 95%; --drift-x:  15px; --color: #ffecb3; --duration: 2s;   --delay: 0.7s;"></div>

        </div>
    </div>
    </div>
    </div>
    </div>
                                    {% if user.is_authenticated %}
            <div class="containerents" style="font-family: 'Arial', sans-serif; background-image: linear-gradient(#12121f 0%, #1a1a2e 100%); display: flex; flex-direction: row; justify-content: center; align-items: center; margin: 0;">
        <div class="notification-bar" style="border-radius: 8px; padding: 15px 20px; color: white; display: flex; flex-direction: column; justify-content: space-between; align-items: center; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); border-bottom: 2px solid #2d3748;">
        <div class="inner-section" style="display: flex; flex-direction: row; padding: 5px;
            margin-top: 4% !important;">
            <div class="left-section" style="display: flex; flex-direction: column;">
                <div class="title-container" style="display: flex; align-items: center; gap: 10px;">
                    <div class="title" style="font-size: 20px; font-weight: bold; text-transform: uppercase; letter-spacing: 1px;">INCOMING</div>
                    <div class="dot" style="width: 12px; height: 12px; background-color: #38b2f8; border-radius: 50%;"></div>
                </div>
                <div class="subtitle" style="font-size: 16px; color: #a0aec0; margin-top: 4px;">Ruby Drop</div>
            </div>
            <div class="right-section" style="display: flex; align-items: center; margin-left: 10px; gap: 15px;">
                <div class="ruby-count" style="display: flex; align-items: center; gap: 8px; background-color: #2d3748; padding: 8px 15px; border-radius: 6px;">
                    <div class="ruby-icon" style="color: #38b2f8; font-size: 20px;">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2L2 7L12 12L22 7L12 2Z" fill="#38b2f8"/>
                            <path d="M2 17L12 22L22 17" stroke="#38b2f8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M2 12L12 17L22 12" stroke="#38b2f8" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </div>
                    <div class="count" id="ruby-count" style="font-size: 18px; font-weight: bold;">2,000</div>
                </div>
                <div class="info-icon" style="width: 24px; height: 24px; background-color: #2d3748; border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; position: relative;">
                    <span style="font-size: 14px; font-weight: bold; color: #a0aec0;">i</span>
                    <div class="tooltip" style="position: absolute; top: 30px; right: 0; width: 150px; background-color: #2d3748; color: white; padding: 10px; border-radius: 6px; font-size: 14px; display: none; z-index: 10; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);">Collect ruby drops to upgrade your items and unlock special features.</div>
                </div>
            </div>
            </div>

<div
  id="halfhour-timer"
  style="
    font-family: Arial, sans-serif;
    background-color: #2d3748;
    color: #38b2f8;
    padding: 8px 15px;
    border-radius: 6px;
    font-size: 18px;
    font-weight: bold;
    margin-left: 15px;
    display: inline-block;
  "
>30:00</div>

<button
  id="ruby-drop-btn"
  style="
    display: none;
    margin-left: 10px;
    padding: 8px 15px;
    border-radius: 6px;
    background-color: #e53e3e;
    color: white;
    border: none;
    font-size: 18px;
    font-weight: bold;
    cursor: pointer;
  "
>Ruby Drop</button>

<!-- replace 'drop-sound.mp3' with your actual audio file -->
<audio id="ruby-sound" src="drop-sound.mp3" preload="auto"></audio>

<script>
const INTERVAL_MS = 30 * 60 * 1000;
const timerEl    = document.getElementById('timer');
const rubyBtn    = document.getElementById('rubyBtn');
const rubySound  = document.getElementById('rubySound');

let currentIntervalStart = getIntervalStart();
window.dropAmount = 0;

function getIntervalStart() {

  return Math.floor(Date.now() / INTERVAL_MS) * INTERVAL_MS;
}

function handleIntervalRollover(prevStart) {
  const clickKey    = 'rubyClicks_' + prevStart;
  const totalClicks = parseInt(localStorage.getItem(clickKey), 10) || 0;
  let reward;

  if (totalClicks < 100) {

    reward = Math.floor(Math.random() * (25 - 10 + 1)) + 10;
  } else {

    reward = Math.round(2500 / totalClicks);
  }

  window.dropAmount = reward;

  localStorage.removeItem(clickKey);
  return reward;
}

function updateCountdown() {
  const now   = Date.now();
  const start = getIntervalStart();

  if (start !== currentIntervalStart) {
    const prevStart = currentIntervalStart;

    const drop    = handleIntervalRollover(prevStart);
    const clicked = localStorage.getItem('rubyClickedInterval') === String(prevStart);

    console.log(
      `üíé Drop calculated: ${drop}. ` +
      `User ${clicked ? 'did' : 'did NOT'} click during that window.`
    );

    currentIntervalStart = start;
    dropFired = false;
    localStorage.removeItem('rubyClickedInterval');
    rubyBtn.classList.remove('clicked');
    rubyBtn.disabled   = false;
    rubyBtn.textContent = 'Ruby Drop';
  }

  const elapsed     = now - start;
  const remainingMs = INTERVAL_MS - elapsed;
  const totalSec    = Math.max(0, Math.ceil(remainingMs / 1000));

  const mins = Math.floor(totalSec / 60);
  const secs = totalSec % 60;
  timerEl.textContent = `${pad(mins)}:${pad(secs)}`;

  if (totalSec > 0 && totalSec < 120) {
    rubyBtn.style.display = 'inline-block';
  } else {
    rubyBtn.style.display = 'none';
  }
}

</script>

<script>
  function pad(n) {
    return n.toString().padStart(2, '0');
  }

  function updateHourlyCountdown() {
    const now = new Date();
    const nextHour = new Date(
      now.getFullYear(),
      now.getMonth(),
      now.getDate(),
      now.getHours() + 1,
      0, 0, 0
    );

    const diffMs   = nextHour - now;
    const totalSec = Math.ceil(diffMs / 1000);
    const minutes  = Math.floor(totalSec / 120);
    const seconds  = totalSec % 60;

    timer.textContent = `${pad(minutes)}:${pad(seconds)}`;

    if (totalSec > 0 && totalSec < 120) {
      timer.style.backgroundColor = '#48bb78';
      timer.style.color = '#fff';
      rubyBtn.style.display = 'inline-block';
    } else {
      timer.style.backgroundColor = '#2d3748';
      timer.style.color = '#38b2f8';
      rubyBtn.style.display = 'none';
    }
  }

  const timer   = document.getElementById('hourly-timer');
  const rubyBtn = document.getElementById('ruby-drop-btn');

  updateHourlyCountdown();
  setInterval(updateHourlyCountdown, 1000);
</script>

        </div>
    </div>

    <script>

        const infoIcon = document.querySelector('.info-icon');
        infoIcon.addEventListener('mouseover', () => {
            const tooltip = infoIcon.querySelector('.tooltip');
            tooltip.style.display = 'block';
        });

        infoIcon.addEventListener('mouseout', () => {
            const tooltip = infoIcon.querySelector('.tooltip');
            tooltip.style.display = 'none';
        });

        function updateRubyCount(count) {
            document.getElementById('ruby-count').textContent = count.toLocaleString();
        }

        setTimeout(() => {
            updateRubyCount(2500);
        }, 3000);
    </script>

    <script>

        function updateRubyCount(count) {
            document.getElementById('ruby-count').textContent = count.toLocaleString();
        }

        setTimeout(() => {
            updateRubyCount(2500);
        }, 3000);

        const infoIcon = document.querySelector('.info-icon');
        infoIcon.addEventListener('click', () => {
            const tooltip = infoIcon.querySelector('.tooltip');
            tooltip.style.display = tooltip.style.display === 'block' ? 'none' : 'block';
        });
    </script>
        {% endif %}
{% endfor %}

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        document.body.classList.add("dark-mode");
      });

      function toggleMode() {
        document.body.classList.toggle("dark-mode");
      }
    </script>

            <div class="sidebar-nav">
                <div class="nav-section">
                    <h3 class="section-title"><i class="fas fa-compass"></i>Home<i class="fas fa-chevron-down toggle-icon"></i></h3>

                    <div class="section-content">
                    <ul>
                        <li class="nav-item">
                            <a href="{% url 'showcase:index' %}" class="nav-link active">
                                <i class="fas fa-home"></i>
                                <span class="nav-text">Home</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            {% if user.is_authenticated %}
                            <a href="{% url 'showcase:order-summary' %}" class="nav-link">
                                <i class="fas fa-shopping-cart"></i>
                                <span class="nav-text">My Cart</span>
                            </a>
                            {% else %}
                            <a href="{% url 'login' %}?next={% url 'showcase:order-summary' %}" class="nav-link">
                                <i class="fas fa-shopping-cart"></i>
                                <span class="nav-text">My Cart</span>
                           </a>
                            {% endif %}
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'showcase:tradingcentral' %}" class="nav-link">
                                <i class="fas fa-exchange-alt"></i>
                                <span class="nav-text">Trades</span>
                                    <span class="nav-badge">3</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'showcase:home' %}" class="nav-link">
                                <i class="fas fa-users"></i>
                                <span class="nav-text">Community</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'showcase:webuy' %}" class="nav-link">
                                <i class="fas fa-dollar"></i>
                                <span class="nav-text">We Buy!</span>
                            </a>
                        </li>
                    </ul>
                    </div>
                </div>

                 <div class="nav-section">
                    <h3 class="section-title"><i class="fas fa-compass"></i> Marketplace<i class="fas fa-chevron-down toggle-icon"></i></h3>
                     <div class="section-content">
                    <ul>
                        {% url 'showcase:index' as index_url %}
                            {% if request.path == index_url %}
                            <li class="nav-item">
                                <a href="#limited" class="nav-link">
                                    <i class="fas fa-hourglass-half"></i>
                                    <span class="nav-text">Limited Edition</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#premium" class="nav-link">
                                    <i class="fa fa-rocket"></i>
                                    <span class="nav-text">Premium</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#featuredgame" class="nav-link">
                                    <i class="fa fa-space-shuttle"></i>
                                    <span class="nav-text">Featured</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#newgame" class="nav-link">
                                    <i class="fas fa-plane"></i>
                                    <span class="nav-text">New</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#populargame" class="nav-link">
                                    <i class="fas fa-fire"></i>
                                    <span class="nav-text">Popular</span>
                                </a>
                            </li>
                            <li class="nav-item">
                                <a href="#marketgame" class="nav-link">
                                    <i class="fas fa-store"></i>
                                    <span class="nav-text">Showcase</span>
                                </a>
                            </li>

                        {% else %}
                                <li class="nav-item">
                                    <a href="{% url 'showcase:index' %}#limited" class="nav-link">
                                        <i class="fas fa-hourglass-half"></i>
                                        <span class="nav-text">Limited Edition</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="{% url 'showcase:index' %}#premium" class="nav-link">
                                        <i class="fa fa-rocket"></i>
                                        <span class="nav-text">Premium</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="{% url 'showcase:index' %}#featuredgame" class="nav-link">
                                        <i class="fa fa-space-shuttle"></i>
                                        <span class="nav-text">Featured</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="{% url 'showcase:index' %}#newgame" class="nav-link">
                                        <i class="fas fa-plane"></i>
                                        <span class="nav-text">New</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="{% url 'showcase:index' %}#populargame" class="nav-link">
                                        <i class="fas fa-fire"></i>
                                        <span class="nav-text">Popular</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="{% url 'showcase:index' %}#marketgame" class="nav-link">
                                        <i class="fas fa-store"></i>
                                        <span class="nav-text">Showcase</span>
                                    </a>
                                </li>

                        {% endif %}
                                <li class="nav-item">
                                    <a href="{% url 'showcase:ehome' %}" class="nav-link">
                                        <i class="fas fa-globe"></i>
                                        <span class="nav-text">Marketplace</span>
                                    </a>
                                </li>
                    </ul>
                    </div>
                </div>

                <!-- Collection Navigation -->
                <div class="nav-section">
                    <h3 class="section-title"><i class="fas fa-layer-group"></i> Orders<i class="fas fa-chevron-down toggle-icon"></i></h3>
                    <div class="section-content">
                    <ul>

                        <li class="nav-item">
                            <a href="#" class="nav-link">
                                <i class="fas fa-star"></i>
                                <span class="nav-text">Favorites</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'showcase:order_history' %}" class="nav-link">
                                <i class="fas fa-history"></i>
                                <span class="nav-text">Order History</span>
                            </a>
                        </li>
                    </ul>
                    </div>
                </div>


                <!-- Settings Navigation -->
                <div class="nav-section">
                    <h3 class="section-title"><i class="fas fa-cog"></i> Settings<i class="fas fa-chevron-down toggle-icon"></i></h3>
                    <div class="section-content">
                    <ul>
                        <li class="nav-item">
               {% for userprofile in NewsProfiles %}

                    {% if userprofile.newprofile_profile_picture_url %}
                      <a href="{{ userprofile.newprofile_profile_url }}" class="nav-link">
                                <i class="fas fa-user-cog"></i>
                                <span class="nav-text">Profile</span>
                            </a>
                    {% else %}
                      <a href="{{ userprofile.newprofile_profile_url }}" class="nav-link">
                                <i class="fas fa-user-cog"></i>
                                <span class="nav-text">Profile</span>
                            </a>

                    {% endif %}

                {% endfor %}
                        </li>
                        <li class="nav-item">
                            <a href="#" class="nav-link">
                                <i class="fas fa-bell"></i>
                                <span class="nav-text">Notifications</span>
                            </a>
                        </li>
                        <li class="nav-item">
                            <a href="{% url 'showcase:changelog' %}" class="nav-link">
                                <i class="fas fa-cog"></i>
                                <span class="nav-text">Changelog</span>
                            </a>
                        </li>
                        {% if user.is_staff %}
                        <li class="nav-item">
                            <a href="{% url 'showcase:administrationchangelog' %}" class="nav-link">
                                <i class="fas fa-magic"></i>
                                <span class="nav-text">Admin Changelog</span>
                            </a>
                        </li>
                        {% endif %}
                        <li class="nav-item">
                            <a href="{% url 'showcase:policy' %}" class="nav-link">
                                <i class="fas fa-shield-alt"></i>
                                <span class="nav-text">Privacy Policy</span>
                            </a>
                        </li>
                        {% if user.is_authenticated %}
                            <form action="{% url 'logout' %}" class="nav-link" method="post" id="logout-form">
                               <li class="nav-item">
                                        {% csrf_token %}
                                        <i class="fas fa-sign-out-alt"></i>
                                        <span class="nav-text" onclick="document.getElementById('logout-form').submit();" style="cursor: pointer; margin-left: 10px;">Logout</span>
                                </li>
                            </form>
                        {% endif %}



                    </ul>
                    </div>

            </div>

            <!-- Progress Section -->
            <div class="progress-section">
                <h3 class="section-title"><i class="fas fa-chart-line"></i> Progress<i class="fas fa-chevron-down toggle-icon"></i></h3>
                    <div class="section-content">
                        <ul>
                            <li class="nav-item">
                <div class="progress-title">
                    <span>Level Progress</span>
                    {% if user.is_authenticated %}

               {% for userprofile in NewsProfiles %}

                    <span>
  {{ userprofile.rubies_spent }}/{{ userprofile.level.experience }}
  ({% widthratio userprofile.rubies_spent userprofile.level.experience 100 %}%)
</span>

                    {% endfor %}

                <div class="progress-bar" style="margin-top: 7px; margin-left: 7px;">
                    <div class="progress-bar" style="width: 100%; height: 10px; background: #ddd; border-radius: 4px; overflow: hidden;">
                        <div class="progress-fill" style="width: {% widthratio userprofile.rubies_spent userprofile.level.experience 100 %}%;">
                        </div>
                    </div>
                </div>
                {% else %}
                <a href="{% url 'login' %}?next={{ request.path }}" style="text-decoration: none; display: flex: flex-direction: column;">
                    <span>
                        Login To Earn EXP!
                    </span>
                <div class="progress-bar" style="margin-top: 7px; margin-left: 7px;">
                    <div class="progress-bar" style="width: 100%; height: 20px; background: #ddd; border-radius: 4px; overflow: hidden;">
                        <div class="progress-fill" style="width: 65%;">
                        </div>
                    </div>
                </div>
                </a>
                {% endif %}
</div>
                            </li>
                        </ul>
            </div>
            </div>

                <div class="volume" style="display: flex; align-items: center; gap: 10px; justify-content: center;">
  <div class="icon">
    <i class="fa fa-volume-up icon-size" aria-hidden="true"></i>
  </div>

  <input
    type="range"
    min="0"
    max="100"
    value="50"
    id="volume-slider"
    step="1"
    class="volume-range"
    aria-label="Volume slider"
  >
  <span class="volume-value">50</span>

  <div class="bar-hoverbox">
    <div class="bar">
      <div class="bar-fill" style="width:50%"></div>
    </div>
  </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const slider    = document.getElementById('volume-slider');
  const fill      = document.querySelector('.bar-fill');
  const ticker    = document.querySelector('.volume-value');
  const icon      = document.querySelector('.volume .icon i');
  const mediaEls  = () => document.querySelectorAll('audio, video');

  function applyVolumePercent(pct) {

    pct = Math.max(0, Math.min(pct, 100));

    slider.value = pct;
    fill.style.width    = pct + '%';
    ticker.textContent  = pct;

    icon.style.color = '';
    if (pct === 0) {
      icon.className = 'fa fa-volume-mute';
    } else if (pct <= 25) {
      icon.className = 'fa fa-volume-off';
    } else if (pct <= 50) {
      icon.className = 'fa fa-volume-down';
    } else if (pct <= 75) {
      icon.className = 'fa fa-volume-up';
    } else {
      icon.className = 'fa fa-volume-up';
      icon.style.color = 'red';
    }

    const frac = pct / 100;
    mediaEls().forEach(m => m.volume = frac);
  }

  let saved = localStorage.getItem('volume');
  let initialPct = saved !== null
                 ? Math.round(parseFloat(saved) * 100)
                 : 100;
  applyVolumePercent(initialPct);

  slider.addEventListener('input', e => {
    const pct = parseInt(e.target.value, 10);
    applyVolumePercent(pct);

    localStorage.setItem('volume', (pct/100).toString());
  });

  window.addEventListener('storage', e => {
    if (e.key === 'volume') {
      const newFrac = parseFloat(e.newValue);
      const newPct  = Math.round(newFrac * 100);
      applyVolumePercent(newPct);
    }
  });

  document.addEventListener('play', ev => {
    if (ev.target instanceof HTMLMediaElement) {
      const currentFrac = parseFloat(localStorage.getItem('volume') ?? '1');
      ev.target.volume = currentFrac;
    }
  }, true);
});
</script>

            <div class="collection">
                <h2 class="collection-title">My Collection</h2>
                    {% if user.is_authenticated %}
                    <a href="{% url 'showcase:inventory' %}" class="collection-item">
                <button class="view-collection" style="display: flex; flex-direction: row; gap: 0px;">
                    üêâ View Collection (<span id="stock-count2">{{ StockObject|length }}</span>)
                </button>
                    </a>
                    {% else %}

                    <a href="{% url 'login' %}?next={{ request.path }}" class="collection-item">
                <button class="view-collection">
                    Login To Collect!
                </button>
                    </a>
                    {% endif %}
            </div>
        </aside>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", () => {
        const sidebarToggle = document.getElementById("sidebarToggle");
        const sidebar = document.querySelector(".sidebar-container");
        const mainContent = document.querySelector(".main-content");
        const navbar = document.querySelector(".main-menu");
        let isCollapsed = false;

        function updateNavbarPosition() {
            if (sidebar.classList.contains("sidebar-hidden")) {
                navbar.style.left = "0";
            } else if (sidebar.classList.contains("sidebar-collapsed")) {
                navbar.style.left = "var(--sidebar-collapsed-width)";
            } else {
                navbar.style.left = "var(--sidebar-width)";
            }
        }

        function setSidebarState(state) {
            sidebar.style.display = "block";
            sidebar.classList.remove("sidebar-hidden", "sidebar-collapsed");
            sidebarToggle.classList.remove("active", "collapsed");
            mainContent?.classList.remove("main-content-expanded");

            switch (state) {
                case "expanded":
                    sidebarToggle.classList.add("active");
                    isCollapsed = false;
                    break;
                case "collapsed":
                    sidebar.classList.add("sidebar-collapsed");
                    sidebarToggle.classList.add("collapsed");
                    mainContent?.classList.add("main-content-expanded");
                    isCollapsed = true;
                    break;
                case "hidden":
                    sidebar.classList.add("sidebar-hidden");
                    setTimeout(() => {
                        if (sidebar.classList.contains("sidebar-hidden")) {
                            sidebar.style.display = "none";
                        }
                    }, 400);
                    isCollapsed = false;
                    break;
            }

            updateNavbarPosition();
        }

        let lastClickTime = 0;
        const doubleClickDelay = 300;

        sidebarToggle.addEventListener("click", (e) => {
            const currentTime = new Date().getTime();
            const timeDiff = currentTime - lastClickTime;

            if (timeDiff < doubleClickDelay) {

                setSidebarState("hidden");
            } else {

                if (sidebar.classList.contains("sidebar-hidden")) {
                    setSidebarState("expanded");
                } else if (isCollapsed) {
                    setSidebarState("hidden");
                } else {
                    setSidebarState("collapsed");
                }
            }

            lastClickTime = currentTime;
        });

        setSidebarState("hidden");

        let resizeTimer;
        window.addEventListener("resize", () => {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(updateNavbarPosition, 250);
        });
    });
</script>
<script>
document.addEventListener("DOMContentLoaded", function() {
    let clickableActive = false;
    let cooldown = false;

    const clickables = [
    {% for uc in Clickables %}
      {
        name:       "{{ uc.clickable.name }}",
        image:      "{{ uc.clickable.image.url }}",
        value:      {{ uc.actual_value }},
        multiplier: {{ uc.exponential_level_multiplier }},
        spawnProb:  1000/{{ uc.clickable.chance_per_second }},
        sound:      new Audio("{{ uc.clickable.sound.url }}")
      }{% if not forloop.last %},{% endif %}
    {% endfor %}
    ];

    console.log("clickables:", clickables);
    console.log("count:", clickables.length);

    function spawnClickable(c) {
        if (clickableActive || cooldown) return;
        clickableActive = true;

        const img = document.createElement("img");
        img.src             = c.image;
        img.style.position  = "fixed";
        img.style.cursor    = "pointer";
        img.style.width     = "80px";
        img.style.height    = "auto";
        img.style.borderRadius = "20px";

        const maxX = window.innerWidth  - 80 - (2.5 * 16);
        const maxY = window.innerHeight - 80 - (3.5 * 16);
        img.style.left = (Math.random() * maxX + (2.5 * 16)) + "px";
        img.style.top  = (Math.random() * maxY + (3.5 * 16)) + "px";

        img.addEventListener("click", () => {
            clickableActive = false;
            cooldown = true;
            img.remove();
            c.sound.play();

            fetch("{% url 'showcase:update_currency' %}", {
                method: "POST",
                headers: {
                    "X-CSRFToken": "{{ csrf_token }}",
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    clickable_name:          c.name,
                    actual_value:            c.value,
                    exponential_multiplier:  c.multiplier
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    document.getElementById("currency-amount").textContent = data.new_amount;
                } else {
                    console.error("Currency update failed:", data.error);
                }
            });

            const msCd = (1 / c.spawnProb / 100) * 1000;
            setTimeout(() => { cooldown = false; }, msCd);
        });

        document.body.appendChild(img);
    }

    setInterval(() => {
        if (clickableActive || cooldown) return;
        for (let c of clickables) {
            if (Math.random() < c.spawnProb) {
                spawnClickable(c);
                console.log("‚úÖ spawned:", c.name);
                break;
            }
        }
    }, 1000);

    if (clickables.length) {
        spawnClickable(clickables[0]);
        console.log("üîπ forced spawn for testing");
    }
});
</script>
<script>
  document.querySelectorAll('.nav-section').forEach(section => {
    const title = section.querySelector('.section-title');
    title.addEventListener('click', () => {
      section.classList.toggle('collapsed');
    });
  });
</script>

{% if user.is_authenticated %}
<div id="preferencescontainer" style="display: none;  position: fixed; z-index: 30; top: 40%; background: rgba(0, 0, 0, 0.5); padding: 20px; border-radius: 15px;" class="preference-popup">
    {% include 'mypreferences.html' %}
</div>

{% endif %}

</body>